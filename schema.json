{
    "$schema": "http://json-schema.org/schema#",
    "definitions": {
        "agent": {
            "oneOf": [
                {
                    "type": "object",
                    "properties": {
                        "person": {
                            "type": "object",
                            "properties": {
                                "surname": {
                                    "type": "string"
                                },
                                "firstname": {
                                    "type": "string"
                                },
                                "email": {
                                    "type": "string"
                                },
                                "organisation": {
                                    "type": "string"
                                }
                            },
                            "additionalProperties": false,
                            "minProperties": 1
                        }
                    },
                    "additionalProperties": false,
                    "required": [
                        "person"
                    ]
                },
                {
                    "type": "object",
                    "properties": {
                        "organisation": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string"
                                }
                            },
                            "required": [
                                "name"
                            ],
                            "additionalProperties": false
                        }
                    },
                    "additionalProperties": false,
                    "required": [
                        "organisation"
                    ]
                }
            ]
        },
        "W3CDate": {
            "type": "string",
            "pattern": "/(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d\\.\\d+)|(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d)|(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d)/"
        },
        "url": {
            "type": "string",
            "pattern": "^(?:(?:https?|ftp)?:?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:\\/[^\\s]*)?$"
        },
        "mimetype": {
            "type": "string",
            "pattern": "[\\w+\\*-]+/[\\w\\*+-]+"
        },
        "fileCollection": {
            "type": "object",
            "properties": {
                "version": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 999
                },
                "files": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/file"
                    }
                }
            },
            "required": [
                "version",
                "files"
            ]
        },
        "file": {
            "type": "object",
            "properties": {
                "version": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 999
                },
                "migrationAction": {
                    "type": "object",
                    "properties": {
                        "pathway": {
                            "$ref": "#/definitions/url"
                        },
                        "agent": {
                            "$ref": "#/definitions/agent"
                        },
                        "generated": {
                            "$ref": "#/definitions/W3CDate"
                        }
                    }
                },
                "format": {
                    "type": "string"
                },
                "mimetype": {
                    "$ref": "#/definitions/mimetype"
                },
                "filesize": {
                    "type": "number",
                    "minimum": 0
                }
            }
        }
    },
    "type": "object",
    "properties": {
        "title": {
            "type": "string"
        },
        "created": {
            "$ref": "#/definitions/W3CDate"
        },
        "creators": {
            "type": "array",
            "items": {
                "items": {
                    "$ref": "#/definitions/agent"
                }
            }
        },
        "recipients": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/agent"
            }
        },
        "attachedTo": {
            "type": "string"
        },
        "versions": {
            "oneOf": [
                {
                    "type": "array",
                    "items": [
                        {
                            "$ref": "#/definitions/file"
                        },
                        {
                            "$ref": "#/definitions/fileCollection"
                        }
                    ]
                }
            ]
        },
        "series": {
            "type": "number"
        },
        "disposalRule": {
            "type": "object",
            "properties": {
                "authority": {
                    "type": "string"
                },
                "class": {
                    "type": "string"
                }
            },
            "required": [
                "authority",
                "class"
            ],
            "additionalProperties": false
        },
        "accessRule": {
            "type": "object",
            "properties": {
                "accessDirection": {
                    "type": "number"
                },
                "effect": {
                    "type": "string",
                    "enum": [
                        "Early",
                        "OPA",
                        "CPA"
                    ]
                },
                "calculateFrom": {
                    "$ref": "#/definitions/W3CDate"
                }
            },
            "required": [
                "accessDirection",
                "effect",
                "calculateFrom"
            ],
            "additionalProperties": false
        }
    },
    "required": [
        "title",
        "series",
        "disposalRule",
        "accessRule"
    ],
    "additionalProperties": false
}
